<!doctype html>
<head>
	<title>Title ~ js1024</title>
	<meta name="author" content="Author"></meta>
	<meta name="description" content="Short description"></meta>
	<meta name="title" content="Title"></meta>
	<meta charset=utf-8>
</head>
<body id=b>
<canvas id=a></canvas>
<style>
* { margin: 0; padding: 0; box-sizing: border-box; }
#a { position: relative; } /* to be changed */
.play { position: fixed; top: 50%; left: 50%; transform: translateX(-50%)translateY(-50%); font-size: 30px; font-family: arial, sans-serif; background: #f3f4f5; padding: 15px; border: 2px solid #ddd; border-radius: 5px;
</style>

<script>

// Entry configuration
// ===================

var title = "Title"; // this will be assigned automatically

// Shim setup and polyfills (do not edit)
// ======================================

// canvas automatically adjusted !
a.width = innerWidth;
a.height = innerHeight;

c = a.getContext("2d"); // no more $type conditional

d = document;
window.AudioContext = window.AudioContext || window.webkitAudioContext;
window.requestAnimationFrame = window.requestAnimationFrame || window.mozRequestAnimationFrame || window.webkitRequestAnimationFrame || window.msRequestAnimationFrame;
a.requestPointerLock = a.requestPointerLock || a.mozRequestPointerLock || a.webkitRequestPointerLock;
navigator.getUserMedia = navigator.getUserMedia || navigator.webkitGetUserMedia || navigator.mozGetUserMedia || navigator.msGetUserMedia;
if (typeof OscillatorNode !== 'undefined' && OscillatorNode.prototype) {
  OscillatorNode.prototype.start = OscillatorNode.prototype.start || OscillatorNode.prototype.noteOn;
  OscillatorNode.prototype.stop = OscillatorNode.prototype.stop || OscillatorNode.prototype.noteOff;
}

// Add a start button if sound is present in the code
onload = () => {
  var entry_code = entry.innerText;
  var has_sound = false;
  if(entry_code.includes('eval')){
    try {
      eval(entry_code.replace(/eval\(/g, 'throw(').replace(/eval\`/g, 'throw`'));
    }
    catch(e){
      entry_code = e;
    }
  }
  if(entry_code.includes("AudioContext")||entry_code.includes("Oscillator")||entry_code.includes("speak")||entry_code.includes("play")||entry_code.includes("autoplay")){
    b.insertAdjacentHTML("beforeEnd", "<button class='play' onclick='console.log(entry.innerText);eval(entry.innerText);this.remove()'>PLAY</button>");
  }
  else {
    eval(entry.innerText);
  }
};
console.log(
  a, // canvas
  b, // body
  c, // 2D canvas context
  d  // document
);

</script>

<script type=text id=entry>
    e='constructor';f=e[e][e];f(`f("w=[];k=[];n=[];m=Math;z=a.width;j=a.height;P=p=>{$u=p.x,v=p.y,g=.3,d=2e3+m.random()*8e3;p.f=!1;n.push(t=>{if(p.f=t>d){p.y+=g;$ {x,y}=p;p.x+=p.x-u;p.y+=p.y-v;u=x;v=y;}});->p;};S=s=>{$ {a,b}=s,u=b.x-a.x,v=b.y-a.y,g=m.sqrt(u*u+v*v);k.push(_=>{u=b.x-a.x;v=b.y-a.y;$h=m.sqrt(u*u+v*v),d=g-h,p=d*u/h,q=d*v/h;if(a.f&&b.f){a.x-=p/2;a.y-=q/2;b.x+=p/2;b.y+=q/2;->0;}if(a.f&&!b.f){a.x-=p;a.y-=q;->0;}if(!a.f&&b.f){b.x+=p;b.y+=q;}});w.push(_=>{c.moveTo(a.x,a.y);c.lineTo(b.x,b.y);});->s;};C=f('$g=[...arguments],s,p;g.forEach(n=>{$a=p;$b=P({x:z/2-150+20*(n%15),y:j/2-150+20*m.floor(n/15)});if(!s){s=p=b;->0;}S({a,b});p=b;});S({a:p,b:s});');C(5,7,97,93,63,64,79,81,21,20);(r=t=>{c.clearRect(0,0,z,j);c.beginPath();n.forEach(_=>_(t));k.forEach(_=>_());w.forEach(_=>_());c.stroke();requestAnimationFrame(r);})(0)".replace(/->([^~]+?);/g,"return $1").replace(/[$]/g,"let "))()`)()
let html;
setInterval(() => {
    fetch('index.html').then(response => response.text()).then(newHtml => { if (html && newHtml != html) { location.reload(); }; html = newHtml; });
}, 1000);

</script>
</body>
