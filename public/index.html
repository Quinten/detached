<!doctype html>
<head>
	<title>Title ~ js1024</title>
	<meta name="author" content="Author"></meta>
	<meta name="description" content="Short description"></meta>
	<meta name="title" content="Title"></meta>
	<meta charset=utf-8>
</head>
<body id=b>
<canvas id=a></canvas>
<style>
* { margin: 0; padding: 0; box-sizing: border-box; }
#a { position: relative; } /* to be changed */
.play { position: fixed; top: 50%; left: 50%; transform: translateX(-50%)translateY(-50%); font-size: 30px; font-family: arial, sans-serif; background: #f3f4f5; padding: 15px; border: 2px solid #ddd; border-radius: 5px;
</style>

<script>

// Entry configuration
// ===================

var title = "Title"; // this will be assigned automatically

// Shim setup and polyfills (do not edit)
// ======================================

// canvas automatically adjusted !
a.width = innerWidth;
a.height = innerHeight;

c = a.getContext("2d"); // no more $type conditional

d = document;
window.AudioContext = window.AudioContext || window.webkitAudioContext;
window.requestAnimationFrame = window.requestAnimationFrame || window.mozRequestAnimationFrame || window.webkitRequestAnimationFrame || window.msRequestAnimationFrame;
a.requestPointerLock = a.requestPointerLock || a.mozRequestPointerLock || a.webkitRequestPointerLock;
navigator.getUserMedia = navigator.getUserMedia || navigator.webkitGetUserMedia || navigator.mozGetUserMedia || navigator.msGetUserMedia;
if (typeof OscillatorNode !== 'undefined' && OscillatorNode.prototype) {
  OscillatorNode.prototype.start = OscillatorNode.prototype.start || OscillatorNode.prototype.noteOn;
  OscillatorNode.prototype.stop = OscillatorNode.prototype.stop || OscillatorNode.prototype.noteOff;
}

// Add a start button if sound is present in the code
onload = () => {
  var entry_code = entry.innerText;
  var has_sound = false;
  if(entry_code.includes('eval')){
    try {
      eval(entry_code.replace(/eval\(/g, 'throw(').replace(/eval\`/g, 'throw`'));
    }
    catch(e){
      entry_code = e;
    }
  }
  if(entry_code.includes("AudioContext")||entry_code.includes("Oscillator")||entry_code.includes("speak")||entry_code.includes("play")||entry_code.includes("autoplay")){
    b.insertAdjacentHTML("beforeEnd", "<button class='play' onclick='console.log(entry.innerText);eval(entry.innerText);this.remove()'>PLAY</button>");
  }
  else {
    eval(entry.innerText);
  }
};
console.log(
  a, // canvas
  b, // body
  c, // 2D canvas context
  d  // document
);

</script>

<script type=text id=entry>
    e='constructor';f=e[e][e];f(`f("$point=p=>{$ u = p.x, v = p.y, g = 1;p.f = !0;p.n = _=> {if (p.f) {p.y += g;$ {x,y} = p;p.x += p.x - u;p.y += p.y - v;u = x;v = y;}c.fillRect(p.x,p.y,12,12);};-> p;};$stick=s=>{$ {a,b} = s;$ dx = b.x - a.y;$ dy = b.y - a.y;$ g = Math.sqrt(dx * dx + dy * dy);s.n = _=> {dx = b.x - a.x;dy = b.y - a.y;$ h = Math.sqrt(dx * dx + dy * dy);$ d = g - h;$ ox = (d * dx / h) / 2;$ oy = (d * dy / h) / 2;if (a.f && b.f) {a.x -= ox;a.y -= oy;b.x += ox;b.y += oy;} else if (a.f && !b.f) {a.x -= ox * 2;a.y -= oy * 2;} else if (!a.f && b.f) {b.x += ox * 2;b.y += oy * 2;}};-> s;};pA = point({x: 100, y: 100});pB = point({x: 200, y: 200});pB.f = !1;sA = stick({a: pA, b: pB});(m=_=>{c.clearRect(0, 0, a.width, a.height);pA.n();pB.n();sA.n();requestAnimationFrame(m);})()".replace(/->([^~]+?);/g,"return $1").replace(/[$]/g,"let "))()`)()
let html;
setInterval(() => {
    fetch('index.html').then(response => response.text()).then(newHtml => { if (html && newHtml != html) { location.reload(); }; html = newHtml; });
}, 1000);

</script>
</body>
